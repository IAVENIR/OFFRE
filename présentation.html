<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IAvenir - Pr√©sentation Commerciale</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            iavenir: {
              50: '#f5f3ff',
              100: '#ede9fe',
              200: '#ddd6fe',
              300: '#c4b5fd',
              400: '#a78bfa',
              500: '#8B5CF6',
              600: '#7c3aed',
              700: '#6d28d9',
              800: '#5b21b6',
              900: '#4c1d95'
            }
          }
        }
      }
    }
  </script>
  <style>
    html { scroll-behavior: smooth; }
  </style>
</head>
<body class="bg-gray-50">
  <div id="app"></div>

  <script>
    const state = {
      includeAudit: true,
      includeFormation: true,
      nextMeetingDate: '',
      auditConfig: { collaborateurs: 100 },
      formationConfig: { format: 'presentiel', duration: 1, participants: 10 }
    };

    const icons = {
      search: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>',
      graduationCap: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/></svg>',
      lightbulb: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>',
      check: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>',
      trendingUp: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>',
      clock: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
      users: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>',
      award: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/></svg>',
      barChart: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>',
      heart: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>',
      star: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>',
      phone: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>',
      mail: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>',
      globe: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>',
      building: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>',
      monitor: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>',
      alertCircle: '<svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
      chevronDown: '<svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>'
    };

    function calculateAuditDays(collaborateurs) {
      if (collaborateurs <= 50) return 3;
      if (collaborateurs <= 100) return 5;
      if (collaborateurs <= 200) return 7;
      if (collaborateurs <= 500) return 9;
      return 10;
    }

    function calculateAudit() {
      const days = calculateAuditDays(state.auditConfig.collaborateurs);
      const total = (days * 1000) + 1500;
      return { days, total };
    }

    function calculateFormation() {
      const prices = { 0.5: 1400, 1: 2900, 2: 4900 };
      const pricePerSession = prices[state.formationConfig.duration];
      const sessions = Math.ceil(state.formationConfig.participants / 12);
      const total = pricePerSession * sessions;
      let discount = 0;
      if (sessions >= 6) discount = 0.20;
      else if (sessions >= 4) discount = 0.15;
      else if (sessions >= 2) discount = 0.10;
      const discountAmount = total * discount;
      const final = total - discountAmount;
      return { pricePerSession, sessions, total, discount, discountAmount, final };
    }

    function calculateROI() {
      const avgSalary = 3500;
      const participants = state.formationConfig.participants;
      const minTimeSaved = 2;
      const maxTimeSaved = state.includeAudit ? 5 : 2;
      const avgTimeSaved = state.includeAudit ? 3.5 : 2;
      const adoptionMultiplier = 0.75;
      const maturityBonus = 1.15;
      const licenseCostPerUser = 25;
      const hourlyRate = avgSalary / 151.67;
      const adjustedAvgTime = avgTimeSaved * adoptionMultiplier * maturityBonus;
      const avgWeeklyGains = participants * adjustedAvgTime * hourlyRate;
      const monthlyLicenseCost = licenseCostPerUser * participants;
      const avgMonthlyGains = (avgWeeklyGains * 4.33) - monthlyLicenseCost;
      const totalInvestment = (state.includeAudit ? calculateAudit().total : 0) + (state.includeFormation ? calculateFormation().final : 0);
      const avgPayback = avgMonthlyGains > 0 ? totalInvestment / avgMonthlyGains : 0;
      return { minTimeSaved, maxTimeSaved, avgMonthlyGains, totalInvestment, avgPayback, monthlyLicenseCost };
    }

    function formatPrice(n) {
      return new Intl.NumberFormat('fr-FR').format(Math.round(n)) + ' ‚Ç¨';
    }

    function render() {
      const audit = calculateAudit();
      const formation = calculateFormation();
      const roi = calculateROI();
      const totalDevis = (state.includeAudit ? audit.total : 0) + (state.includeFormation ? formation.final : 0);
      
      document.getElementById('app').innerHTML = `
        <nav class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-sm shadow-sm z-50">
          <div class="max-w-7xl mx-auto px-6 py-3">
            <div class="flex items-center justify-between">
              <div class="text-2xl font-bold text-iavenir-500">IAvenir</div>
              <div class="hidden md:flex items-center gap-6 text-sm">
                <a href="#methodologie" class="text-gray-600 hover:text-iavenir-500 transition">M√©thodologie</a>
                <a href="#resultats" class="text-gray-600 hover:text-iavenir-500 transition">R√©sultats</a>
                <a href="#configurateur" class="text-gray-600 hover:text-iavenir-500 transition">Configurateur</a>
                <a href="#action" class="bg-iavenir-500 text-white px-4 py-2 rounded-full hover:bg-iavenir-600 transition">Passer √† l'action</a>
                <button onclick="exportPresentation()" class="border-2 border-iavenir-500 text-iavenir-500 px-4 py-2 rounded-full hover:bg-iavenir-50 transition flex items-center gap-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                  PDF
                </button>
              </div>
            </div>
          </div>
        </nav>

        <section class="bg-white pt-24 pb-16">
          <div class="max-w-6xl mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4 text-gray-900">Transformez votre entreprise<br>gr√¢ce √† l'IA</h1>
            <p class="text-xl text-gray-600 mb-12 max-w-2xl mx-auto">De l'audit strat√©gique √† la mont√©e en comp√©tences de vos √©quipes,<br>nous vous accompagnons √† chaque √©tape.</p>
            
            <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto mb-12">
              <div class="bg-gray-50 p-8 rounded-2xl border-2 border-gray-200">
                <div class="inline-block mb-4 px-4 py-2 bg-gray-200 rounded-full text-gray-700 text-sm font-bold">POINT A ¬∑ AUJOURD'HUI</div>
                <div class="w-16 h-16 bg-gray-200 rounded-xl flex items-center justify-center mb-4 mx-auto text-gray-500">${icons.alertCircle}</div>
                <h3 class="text-2xl font-bold mb-4 text-gray-800">Votre Situation</h3>
                <p class="text-gray-500 text-lg italic">√Ä d√©finir ensemble lors de notre √©change...</p>
              </div>
              <div class="bg-iavenir-500 p-8 rounded-2xl shadow-xl text-white">
                <div class="inline-block mb-4 px-4 py-2 bg-white/20 rounded-full text-white text-sm font-bold">POINT B ¬∑ DANS 2-3 MOIS</div>
                <div class="w-16 h-16 bg-white/20 rounded-xl flex items-center justify-center mb-4 mx-auto">${icons.trendingUp}</div>
                <h3 class="text-2xl font-bold mb-4">Vos R√©sultats</h3>
                <div class="text-left space-y-3">
                  <div class="flex items-start gap-3"><span class="mt-1">${icons.check}</span><div><p class="font-bold">+15% √† +40% de productivit√©</p><p class="text-sm text-white/80">Gains mesurables sur les t√¢ches quotidiennes</p></div></div>
                  <div class="flex items-start gap-3"><span class="mt-1">${icons.check}</span><div><p class="font-bold">√âquipes autonomes et confiantes</p><p class="text-sm text-white/80">Form√©es sur VOS cas d'usage m√©tier</p></div></div>
                  <div class="flex items-start gap-3"><span class="mt-1">${icons.check}</span><div><p class="font-bold">ROI mesurable et prouv√©</p><p class="text-sm text-white/80">Retour sur investissement en quelques mois</p></div></div>
                  <div class="flex items-start gap-3"><span class="mt-1">${icons.check}</span><div><p class="font-bold">Avantage comp√©titif durable</p><p class="text-sm text-white/80">Une organisation qui ma√Ætrise l'IA</p></div></div>
                </div>
              </div>
            </div>
            <div class="animate-bounce text-gray-400">${icons.chevronDown}</div>
          </div>
        </section>

        <section id="methodologie" class="py-16 bg-white">
          <div class="max-w-6xl mx-auto px-6">
            <div class="text-center mb-12">
              <h2 class="text-3xl font-bold text-gray-900 mb-3">Notre M√©thodologie</h2>
              <p class="text-gray-600 max-w-2xl mx-auto">Un processus structur√© en 3 √©tapes pour une transformation IA r√©ussie</p>
              
              <!-- Frise Aujourd'hui -> IA Performance -> IA Excellence -->
              <div class="mt-8 max-w-2xl mx-auto">
                <div class="bg-gradient-to-r from-gray-300 via-iavenir-400 to-iavenir-600 h-2 rounded-full mb-3"></div>
                <div class="flex justify-between text-sm">
                  <span class="font-semibold text-gray-600">Aujourd'hui</span>
                  <span class="font-semibold text-iavenir-500">IA Performance</span>
                  <span class="font-semibold text-iavenir-700">IA Excellence</span>
                </div>
              </div>
            </div>
            
            <div class="relative">
              <!-- Ligne verticale -->
              <div class="absolute left-1/2 top-0 bottom-0 w-1 bg-gradient-to-b from-iavenir-300 via-iavenir-500 to-iavenir-700 hidden md:block"></div>
              
              <div class="space-y-12">
                <!-- √âtape 1 - Audit -->
                <div class="relative">
                  <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="md:text-right md:pr-12">
                      <div class="inline-block mb-3 px-3 py-1 bg-iavenir-100 border border-iavenir-200 rounded-full text-iavenir-700 text-sm font-semibold">
                        √âtape 1 ¬∑ 3 √† 10 jours
                      </div>
                      <h3 class="text-3xl font-bold mb-4 text-iavenir-600">Audit Strat√©gique</h3>
                      <p class="text-gray-600 mb-6">Analyse approfondie de votre organisation pour identifier les opportunit√©s IA √† fort impact.</p>
                      
                      <div class="space-y-3">
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3 md:flex-row-reverse md:justify-end">
                            <div class="w-10 h-10 bg-iavenir-500 rounded-lg flex items-center justify-center text-white">${icons.search}</div>
                            <div class="text-left md:text-right">
                              <div class="font-bold text-iavenir-900">Immersion</div>
                              <div class="text-sm text-gray-600">Observation terrain, entretiens √©quipes</div>
                            </div>
                          </div>
                        </div>
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3 md:flex-row-reverse md:justify-end">
                            <div class="w-10 h-10 bg-iavenir-500 rounded-lg flex items-center justify-center text-white">${icons.barChart}</div>
                            <div class="text-left md:text-right">
                              <div class="font-bold text-iavenir-900">Consolidation</div>
                              <div class="text-sm text-gray-600">Analyse des donn√©es, priorisation</div>
                            </div>
                          </div>
                        </div>
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3 md:flex-row-reverse md:justify-end">
                            <div class="w-10 h-10 bg-iavenir-500 rounded-lg flex items-center justify-center text-white">${icons.lightbulb}</div>
                            <div class="text-left md:text-right">
                              <div class="font-bold text-iavenir-900">Restitution</div>
                              <div class="text-sm text-gray-600">Plan d'action d√©taill√© + quick wins</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="absolute left-1/2 top-0 transform -translate-x-1/2 w-14 h-14 bg-iavenir-500 rounded-full border-4 border-white shadow-lg z-10 flex items-center justify-center hidden md:flex">
                      <span class="text-white font-bold text-xl">1</span>
                    </div>
                    
                    <div class="md:pl-12">
                      <div class="bg-gradient-to-br from-purple-100 to-indigo-100 p-6 rounded-2xl border-2 border-purple-300">
                        <div class="flex items-center gap-3 mb-4">
                          <div class="text-iavenir-600">${icons.award}</div>
                          <h4 class="text-xl font-bold text-purple-900">B√©n√©fices</h4>
                        </div>
                        <ul class="space-y-2">
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Vision claire des opportunit√©s</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">ROI estim√© par cas d'usage</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Roadmap personnalis√©e</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700 font-bold">Gains rapides identifi√©s</span></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- √âtape 2 - Formation -->
                <div class="relative">
                  <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="md:text-right md:pr-12 md:order-2">
                      <div class="bg-gradient-to-br from-purple-100 to-indigo-100 p-6 rounded-2xl border-2 border-purple-300">
                        <div class="flex items-center gap-3 mb-4">
                          <div class="text-iavenir-600">${icons.award}</div>
                          <h4 class="text-xl font-bold text-purple-900">B√©n√©fices</h4>
                        </div>
                        <ul class="space-y-2">
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">√âquipes autonomes rapidement</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Adoption imm√©diate des outils</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Cas pratiques m√©tier</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700 font-bold">Financement OPCO possible</span></li>
                        </ul>
                      </div>
                    </div>
                    
                    <div class="absolute left-1/2 top-0 transform -translate-x-1/2 w-14 h-14 bg-iavenir-500 rounded-full border-4 border-white shadow-lg z-10 flex items-center justify-center hidden md:flex">
                      <span class="text-white font-bold text-xl">2</span>
                    </div>
                    
                    <div class="md:pl-12 md:order-1">
                      <div class="inline-block mb-3 px-3 py-1 bg-iavenir-100 border border-iavenir-200 rounded-full text-iavenir-700 text-sm font-semibold">
                        √âtape 2 ¬∑ 0.5 √† 2 jours
                      </div>
                      <h3 class="text-3xl font-bold mb-4 text-iavenir-600">Formation sur-mesure</h3>
                      <p class="text-gray-600 mb-6">Mont√©e en comp√©tences de vos √©quipes avec des formations adapt√©es √† vos cas d'usage.</p>
                      
                      <div class="space-y-3">
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-iavenir-500 rounded-lg flex items-center justify-center text-white">${icons.users}</div>
                            <div>
                              <div class="font-bold text-iavenir-900">Pr√©sentiel</div>
                              <div class="text-sm text-gray-600">Dans vos locaux, immersion totale</div>
                            </div>
                          </div>
                        </div>
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-iavenir-500 rounded-lg flex items-center justify-center text-white">${icons.globe}</div>
                            <div>
                              <div class="font-bold text-iavenir-900">Distanciel</div>
                              <div class="text-sm text-gray-600">Sessions interactives en visio</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- √âtape 3 - Conseil -->
                <div class="relative">
                  <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="md:text-right md:pr-12">
                      <div class="inline-block mb-3 px-3 py-1 bg-iavenir-100 border border-iavenir-200 rounded-full text-iavenir-700 text-sm font-semibold">
                        √âtape 3 ¬∑ En continu
                      </div>
                      <h3 class="text-3xl font-bold mb-4 text-iavenir-600">Missions de Conseil</h3>
                      <p class="text-gray-600 mb-6">Accompagnement strat√©gique pour optimiser et p√©renniser votre transformation IA.</p>
                      
                      <div class="space-y-3">
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3 md:flex-row-reverse md:justify-end">
                            <div class="w-10 h-10 bg-iavenir-600 rounded-lg flex items-center justify-center text-white">${icons.lightbulb}</div>
                            <div class="text-left md:text-right">
                              <div class="font-bold text-iavenir-900">Innovation Continue</div>
                              <div class="text-sm text-gray-600">Identification de nouveaux cas d'usage</div>
                            </div>
                          </div>
                        </div>
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3 md:flex-row-reverse md:justify-end">
                            <div class="w-10 h-10 bg-iavenir-600 rounded-lg flex items-center justify-center text-white">${icons.barChart}</div>
                            <div class="text-left md:text-right">
                              <div class="font-bold text-iavenir-900">Optimisation ROI</div>
                              <div class="text-sm text-gray-600">Analyse et am√©lioration des performances</div>
                            </div>
                          </div>
                        </div>
                        <div class="bg-iavenir-50 p-4 rounded-xl border border-iavenir-200">
                          <div class="flex items-center gap-3 md:flex-row-reverse md:justify-end">
                            <div class="w-10 h-10 bg-iavenir-600 rounded-lg flex items-center justify-center text-white">${icons.users}</div>
                            <div class="text-left md:text-right">
                              <div class="font-bold text-iavenir-900">Culture IA</div>
                              <div class="text-sm text-gray-600">Ancrage des pratiques dans votre ADN</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="absolute left-1/2 top-0 transform -translate-x-1/2 w-14 h-14 bg-iavenir-700 rounded-full border-4 border-white shadow-lg z-10 flex items-center justify-center hidden md:flex">
                      <span class="text-white font-bold text-xl">3</span>
                    </div>
                    
                    <div class="md:pl-12">
                      <div class="bg-gradient-to-br from-purple-100 to-indigo-100 p-6 rounded-2xl border-2 border-purple-300">
                        <div class="flex items-center gap-3 mb-4">
                          <div class="text-iavenir-600">${icons.award}</div>
                          <h4 class="text-xl font-bold text-purple-900">B√©n√©fices</h4>
                        </div>
                        <ul class="space-y-2">
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Avantage comp√©titif durable</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Veille technologique permanente</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700">Adaptation aux √©volutions IA</span></li>
                          <li class="flex items-start gap-2"><span class="text-iavenir-600 mt-1">${icons.check}</span><span class="text-gray-700 font-bold">Organisation apprenante</span></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section id="resultats" class="py-16 bg-white">
          <div class="max-w-6xl mx-auto px-6">
            <div class="text-center mb-12">
              <h2 class="text-3xl font-bold text-gray-900 mb-3">R√©sultats pour l'entreprise</h2>
              <p class="text-gray-600">Ce que vous pouvez attendre de notre accompagnement</p>
            </div>
            <div class="grid md:grid-cols-3 gap-6 mb-8">
              <div class="bg-gray-50 p-6 rounded-2xl border border-gray-200 text-center">
                <div class="w-12 h-12 bg-iavenir-100 rounded-xl flex items-center justify-center mx-auto mb-4 text-iavenir-600">${icons.clock}</div>
                <div class="text-3xl font-bold text-iavenir-600 mb-2">2-5h</div>
                <div class="text-gray-700 font-semibold mb-2">gagn√©es / personne / semaine</div>
                <div class="text-sm text-gray-500">Temps lib√©r√© pour les t√¢ches strat√©giques</div>
              </div>
              <div class="bg-gray-50 p-6 rounded-2xl border border-gray-200 text-center">
                <div class="w-12 h-12 bg-iavenir-100 rounded-xl flex items-center justify-center mx-auto mb-4 text-iavenir-600">${icons.heart}</div>
                <div class="text-3xl font-bold text-iavenir-600 mb-2">Humain</div>
                <div class="text-gray-700 font-semibold mb-2">Engagement & bien-√™tre</div>
                <div class="text-sm text-gray-500">√âquipes valoris√©es sur des t√¢ches √† forte valeur ajout√©e</div>
              </div>
              <div class="bg-gray-50 p-6 rounded-2xl border border-gray-200 text-center">
                <div class="w-12 h-12 bg-iavenir-100 rounded-xl flex items-center justify-center mx-auto mb-4 text-iavenir-600">${icons.star}</div>
                <div class="text-3xl font-bold text-iavenir-600 mb-2">98%</div>
                <div class="text-gray-700 font-semibold mb-2">Taux de satisfaction</div>
                <div class="text-sm text-gray-500">Nos clients recommandent IAvenir</div>
              </div>
            </div>
            <div class="text-center">
              <div class="inline-flex items-center gap-2 bg-gray-100 px-4 py-2 rounded-full text-gray-700 text-sm font-medium">${icons.award}<span>+50 entreprises nous font d√©j√† confiance</span></div>
            </div>
          </div>
        </section>

        <section id="configurateur" class="py-16 bg-gray-50">
          <div class="max-w-6xl mx-auto px-6">
            <div class="text-center mb-12">
              <h2 class="text-3xl font-bold text-gray-900 mb-3">Configurez votre projet</h2>
              <p class="text-gray-600">Cliquez sur les boutons pour inclure ou exclure les services</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8">
              <div class="bg-white p-6 rounded-2xl border-2 ${state.includeAudit ? 'border-iavenir-500 shadow-lg' : 'border-gray-200'} transition-all">
                <div class="flex items-center justify-between mb-6">
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 ${state.includeAudit ? 'bg-iavenir-500' : 'bg-gray-300'} rounded-lg flex items-center justify-center text-white transition-all">${icons.search}</div>
                    <h3 class="text-xl font-bold text-gray-900">Audit Strat√©gique</h3>
                  </div>
                  <button onclick="toggleAudit()" class="w-14 h-8 rounded-full transition-all relative ${state.includeAudit ? 'bg-iavenir-500' : 'bg-gray-300'}">
                    <div class="w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow ${state.includeAudit ? 'right-1' : 'left-1'}"></div>
                  </button>
                </div>
                ${state.includeAudit ? `
                <div class="space-y-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nombre de collaborateurs dans l'entreprise</label>
                    <input type="number" id="auditCollaborateurs" value="${state.auditConfig.collaborateurs}" min="1" max="5000" class="w-full p-3 rounded-xl border-2 border-gray-200 text-center text-xl font-bold focus:border-iavenir-500 focus:outline-none">
                  </div>
                  <div class="bg-gray-50 p-4 rounded-xl">
                    <div class="flex justify-between items-center mb-2">
                      <span class="text-gray-600">Dur√©e recommand√©e</span>
                      <span class="font-bold text-iavenir-700">${audit.days} jours</span>
                    </div>
                    <div class="border-t border-gray-200 pt-2 mt-2">
                      <div class="flex justify-between items-center">
                        <span class="font-bold text-gray-900">Total Audit</span>
                        <span class="text-2xl font-bold text-iavenir-600">${formatPrice(audit.total)}</span>
                      </div>
                    </div>
                  </div>
                </div>
                ` : '<div class="text-center py-8 text-gray-400"><p>Cliquez sur le bouton pour inclure l\'audit</p></div>'}
              </div>
              
              <div class="bg-white p-6 rounded-2xl border-2 ${state.includeFormation ? 'border-iavenir-500 shadow-lg' : 'border-gray-200'} transition-all">
                <div class="flex items-center justify-between mb-6">
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 ${state.includeFormation ? 'bg-iavenir-500' : 'bg-gray-300'} rounded-lg flex items-center justify-center text-white transition-all">${icons.graduationCap}</div>
                    <div>
                      <h3 class="text-xl font-bold text-gray-900">Formation sur-mesure</h3>
                      <p class="text-xs text-iavenir-600">üéì Certifi√©e Qualiopi</p>
                    </div>
                  </div>
                  <button onclick="toggleFormation()" class="w-14 h-8 rounded-full transition-all relative ${state.includeFormation ? 'bg-iavenir-500' : 'bg-gray-300'}">
                    <div class="w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow ${state.includeFormation ? 'right-1' : 'left-1'}"></div>
                  </button>
                </div>
                ${state.includeFormation ? `
                <div class="space-y-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Format</label>
                    <div class="grid grid-cols-2 gap-2">
                      <button onclick="updateFormationFormat('presentiel')" class="py-3 px-3 rounded-lg text-sm font-medium transition flex items-center justify-center gap-2 ${state.formationConfig.format === 'presentiel' ? 'bg-iavenir-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">
                        <span class="w-5 h-5">${icons.building}</span>Pr√©sentiel
                      </button>
                      <button onclick="updateFormationFormat('distanciel')" class="py-3 px-3 rounded-lg text-sm font-medium transition flex items-center justify-center gap-2 ${state.formationConfig.format === 'distanciel' ? 'bg-iavenir-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">
                        <span class="w-5 h-5">${icons.monitor}</span>Distanciel
                      </button>
                    </div>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Dur√©e</label>
                    <div class="grid grid-cols-3 gap-2">
                      <button onclick="updateFormationDuration(0.5)" class="py-2 px-2 rounded-lg text-sm font-medium transition text-center ${state.formationConfig.duration === 0.5 ? 'bg-iavenir-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">0.5 jour<br><span class="text-xs opacity-75">1 400 ‚Ç¨</span></button>
                      <button onclick="updateFormationDuration(1)" class="py-2 px-2 rounded-lg text-sm font-medium transition text-center ${state.formationConfig.duration === 1 ? 'bg-iavenir-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">1 jour<br><span class="text-xs opacity-75">2 900 ‚Ç¨</span></button>
                      <button onclick="updateFormationDuration(2)" class="py-2 px-2 rounded-lg text-sm font-medium transition text-center ${state.formationConfig.duration === 2 ? 'bg-iavenir-500 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">2 jours<br><span class="text-xs opacity-75">4 900 ‚Ç¨</span></button>
                    </div>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nombre de participants √† former</label>
                    <input type="number" id="formationParticipants" value="${state.formationConfig.participants}" min="1" max="500" class="w-full p-3 rounded-xl border-2 border-gray-200 text-center text-xl font-bold focus:border-iavenir-500 focus:outline-none">
                  </div>
                  <div class="bg-gray-50 p-4 rounded-xl">
                    <div class="flex justify-between items-center mb-2">
                      <span class="text-gray-600">Sessions n√©cessaires</span>
                      <span class="font-bold text-iavenir-700">${formation.sessions} session${formation.sessions > 1 ? 's' : ''}</span>
                    </div>
                    <div class="text-xs text-gray-500 mb-2">12 participants max par session</div>
                    ${formation.discount > 0 ? `<div class="flex justify-between items-center mb-2 text-green-600"><span>Remise volume (-${Math.round(formation.discount * 100)}%)</span><span class="font-medium">-${formatPrice(formation.discountAmount)}</span></div>` : ''}
                    <div class="border-t border-gray-200 pt-2 mt-2">
                      <div class="flex justify-between items-center">
                        <span class="font-bold text-gray-900">Total Formation</span>
                        <span class="text-2xl font-bold text-iavenir-600">${formatPrice(formation.final)}</span>
                      </div>
                    </div>
                  </div>
                </div>
                ` : '<div class="text-center py-8 text-gray-400"><p>Cliquez sur le bouton pour inclure la formation</p></div>'}
              </div>
            </div>
            
            ${(state.includeAudit || state.includeFormation) ? `
            <div class="mt-8 bg-iavenir-500 p-6 rounded-2xl text-white text-center">
              <div class="text-lg mb-2">Investissement total estim√©</div>
              <div class="text-4xl font-bold">${formatPrice(totalDevis)}</div>
              <div class="text-iavenir-200 text-sm mt-2">HT - Hors frais de d√©placement √©ventuels</div>
            </div>
            ` : ''}
            
            <!-- Calculateur ROI -->
            ${state.includeFormation ? `
            <div class="mt-10 bg-white p-8 rounded-2xl border-2 border-iavenir-200 shadow-lg">
              <div class="text-center mb-6">
                <div class="w-12 h-12 bg-iavenir-100 rounded-xl flex items-center justify-center mx-auto mb-3 text-iavenir-600">${icons.trendingUp}</div>
                <h3 class="text-2xl font-bold text-gray-900 mb-1">Votre ROI Estim√©</h3>
                <p class="text-gray-600 text-sm">Bas√© sur ${state.formationConfig.participants} collaborateur(s) form√©(s)</p>
              </div>
              
              <div class="grid md:grid-cols-3 gap-6 mb-6">
                <div class="bg-iavenir-50 p-4 rounded-xl text-center">
                  <div class="text-sm text-gray-600 mb-1">Temps gagn√© / pers. / sem.</div>
                  <div class="text-2xl font-bold text-iavenir-600">
                    ${roi.minTimeSaved === roi.maxTimeSaved ? roi.minTimeSaved + 'h' : roi.minTimeSaved + '-' + roi.maxTimeSaved + 'h'}
                  </div>
                  ${!state.includeAudit ? '<div class="text-xs text-gray-500">(jusqu\'√† 5h avec audit)</div>' : ''}
                </div>
                <div class="bg-iavenir-50 p-4 rounded-xl text-center">
                  <div class="text-sm text-gray-600 mb-1">Gains nets / mois</div>
                  <div class="text-2xl font-bold text-iavenir-600">${formatPrice(roi.avgMonthlyGains)}</div>
                  <div class="text-xs text-gray-500">apr√®s co√ªt licences</div>
                </div>
                <div class="bg-iavenir-50 p-4 rounded-xl text-center">
                  <div class="text-sm text-gray-600 mb-1">Retour sur invest.</div>
                  <div class="text-2xl font-bold text-iavenir-600">${roi.avgPayback > 0 ? roi.avgPayback.toFixed(1) + ' mois' : '-'}</div>
                </div>
              </div>
              
              <div class="bg-gray-50 p-4 rounded-xl">
                <div class="text-sm font-semibold text-gray-700 mb-2">Hypoth√®ses de calcul</div>
                <ul class="text-xs text-gray-600 space-y-1">
                  <li>‚Ä¢ Salaire moyen charg√© : 3 500 ‚Ç¨/mois</li>
                  <li>‚Ä¢ Taux d'adoption : 75%</li>
                  <li>‚Ä¢ Bonus maturit√© (avec formation) : +15%</li>
                  <li>‚Ä¢ Co√ªt licences IA : 25 ‚Ç¨/utilisateur/mois</li>
                </ul>
                <div class="mt-3 pt-3 border-t border-gray-200">
                  <div class="text-sm font-semibold text-gray-700 mb-1">Non pris en compte (bonus)</div>
                  <ul class="text-xs text-gray-500 space-y-1">
                    <li>‚Ä¢ Gains humains (satisfaction, motivation)</li>
                    <li>‚Ä¢ Prise en charge OPCO possible</li>
                    <li>‚Ä¢ Am√©lioration qualit√© des livrables</li>
                    <li>‚Ä¢ Avantage comp√©titif</li>
                  </ul>
                </div>
              </div>
            </div>
            ` : ''}
          </div>
        </section>

        <section id="action" class="py-16 bg-gray-800 text-white">
          <div class="max-w-5xl mx-auto px-6">
            <div class="text-center mb-10">
              <h2 class="text-3xl font-bold mb-3">Pr√™t √† passer √† l'action ?</h2>
              <p class="text-gray-400">Voici les prochaines √©tapes de notre collaboration</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6">
              <div class="bg-gray-700/50 p-6 rounded-2xl border border-gray-600">
                <h3 class="text-lg font-bold mb-6 flex items-center gap-2">${icons.clock} Prochaines √©tapes</h3>
                
                <!-- Point de d√©part -->
                <div class="text-center mb-4">
                  <div class="inline-flex items-center gap-2 bg-iavenir-500 text-white px-4 py-2 rounded-full font-semibold text-sm">
                    <span class="w-5 h-5 bg-white text-iavenir-600 rounded-full flex items-center justify-center text-xs font-bold">1</span>
                    Point le : ${state.nextMeetingDate ? new Date(state.nextMeetingDate).toLocaleDateString('fr-FR', {day: 'numeric', month: 'short'}) : '...'}
                  </div>
                </div>
                
                <!-- Ligne verticale -->
                <div class="flex justify-center mb-2"><div class="w-0.5 h-4 bg-gray-500"></div></div>
                
                <!-- Question -->
                <div class="text-center mb-3">
                  <span class="text-xs text-gray-400 bg-gray-600 px-3 py-1 rounded-full">On avance ensemble ?</span>
                </div>
                
                <!-- Deux branches -->
                <div class="grid grid-cols-2 gap-3">
                  <!-- Non -->
                  <div class="text-center">
                    <div class="text-xs text-gray-500 mb-2">‚Üª Pas maintenant</div>
                    <div class="bg-gray-600/50 p-2 rounded-lg text-xs text-gray-400">On reste en contact</div>
                  </div>
                  <!-- Oui -->
                  <div class="text-center">
                    <div class="text-xs text-iavenir-400 mb-2">‚úì On avance</div>
                    <div class="space-y-1 text-xs">
                      <div class="bg-gray-600/50 p-1 rounded text-gray-300">Signature</div>
                      <div class="bg-gray-600/50 p-1 rounded text-gray-300">Kick-off</div>
                      ${state.includeAudit ? '<div class="bg-gray-600/50 p-1 rounded text-gray-300">Audit</div>' : ''}
                      ${state.includeFormation ? '<div class="bg-gray-600/50 p-1 rounded text-gray-300">Formation</div>' : ''}
                      <div class="bg-green-900/50 p-1 rounded text-green-400 font-semibold">R√©sultats ‚úì</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="bg-gray-700/50 p-6 rounded-2xl border border-gray-600">
                <h3 class="text-lg font-bold mb-6 flex items-center gap-2">${icons.barChart} R√©capitulatif Devis</h3>
                <div class="space-y-4">
                  ${state.includeAudit ? `<div class="flex justify-between items-center pb-3 border-b border-gray-600"><div><div class="font-semibold">Audit Strat√©gique</div><div class="text-xs text-gray-400">${audit.days} jours</div></div><div class="text-lg font-bold text-iavenir-300">${formatPrice(audit.total)}</div></div>` : ''}
                  ${state.includeFormation ? `<div class="flex justify-between items-center pb-3 border-b border-gray-600"><div><div class="font-semibold">Formation</div><div class="text-xs text-gray-400">${formation.sessions} session${formation.sessions > 1 ? 's' : ''} ¬∑ ${state.formationConfig.participants} pers.</div></div><div class="text-lg font-bold text-iavenir-300">${formatPrice(formation.final)}</div></div>` : ''}
                  ${(state.includeAudit || state.includeFormation) ? `
                  <div class="flex justify-between items-center pt-2"><div class="font-bold text-lg">TOTAL</div><div class="text-2xl font-bold text-white">${formatPrice(totalDevis)}</div></div>
                  <div class="text-xs text-gray-400 text-center">HT - Hors frais de d√©placement</div>
                  <div class="mt-4 pt-4 border-t border-gray-600">
                    <label class="block text-xs text-gray-400 mb-2">üìÖ Date du prochain RDV</label>
                    <input type="date" id="nextMeetingDate" value="${state.nextMeetingDate}" class="w-full p-2 rounded-lg bg-gray-600 border border-gray-500 text-white text-sm focus:border-iavenir-400 focus:outline-none">
                  </div>
                  <button onclick="exportPDF()" class="mt-4 w-full bg-iavenir-500 hover:bg-iavenir-600 text-white py-2 px-4 rounded-lg font-semibold transition flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                    Exporter en PDF
                  </button>
                  ` : '<div class="text-center text-gray-400 py-4">S√©lectionnez des services</div>'}
                </div>
              </div>
              
              <div class="bg-gray-700/50 p-6 rounded-2xl border border-gray-600">
                <h3 class="text-lg font-bold mb-6 flex items-center gap-2">${icons.users} Votre contact</h3>
                <div class="space-y-4">
                  <div class="flex items-center gap-3">
                    <div class="w-12 h-12 bg-iavenir-500 rounded-full flex items-center justify-center text-lg font-bold">ML</div>
                    <div>
                      <div class="font-bold">Mathieu Legeas</div>
                      <div class="text-gray-400 text-sm">Fondateur</div>
                    </div>
                  </div>
                  <div class="space-y-2 pt-2">
                    <a href="tel:+33761602277" class="flex items-center gap-2 text-sm text-gray-300 hover:text-white transition"><span class="w-8 h-8 bg-gray-600 rounded-lg flex items-center justify-center">${icons.phone}</span>07 61 60 22 77</a>
                    <a href="mailto:mathieu.legeas@iavenir-formation.fr" class="flex items-center gap-2 text-sm text-gray-300 hover:text-white transition"><span class="w-8 h-8 bg-gray-600 rounded-lg flex items-center justify-center">${icons.mail}</span><span class="truncate text-xs">mathieu.legeas@iavenir-formation.fr</span></a>
                  </div>
                  <div class="pt-3 border-t border-gray-600">
                    <div class="flex items-center gap-2 text-xs text-gray-400">${icons.award} Organisme certifi√© Qualiopi</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <footer class="bg-gray-900 text-gray-400 py-6 border-t border-gray-800">
          <div class="max-w-6xl mx-auto px-6 text-center">
            <div class="text-xl font-bold text-white mb-1">IAvenir</div>
            <p class="text-sm">Formation et conseil en Intelligence Artificielle</p>
            <p class="text-xs mt-2">¬© 2025 IAvenir - Tous droits r√©serv√©s</p>
          </div>
        </footer>
      `;
      attachEvents();
    }

    function toggleAudit() { state.includeAudit = !state.includeAudit; render(); }
    function toggleFormation() { state.includeFormation = !state.includeFormation; render(); }
    function updateFormationFormat(format) { state.formationConfig.format = format; render(); }
    function updateFormationDuration(duration) { state.formationConfig.duration = duration; render(); }

    function attachEvents() {
      const auditInput = document.getElementById('auditCollaborateurs');
      if (auditInput) auditInput.addEventListener('change', (e) => { state.auditConfig.collaborateurs = parseInt(e.target.value) || 1; render(); });
      const formationInput = document.getElementById('formationParticipants');
      if (formationInput) formationInput.addEventListener('change', (e) => { state.formationConfig.participants = parseInt(e.target.value) || 1; render(); });
      const dateInput = document.getElementById('nextMeetingDate');
      if (dateInput) dateInput.addEventListener('change', (e) => { state.nextMeetingDate = e.target.value; });
    }

    window.toggleAudit = toggleAudit;
    window.toggleFormation = toggleFormation;
    window.updateFormationFormat = updateFormationFormat;
    window.updateFormationDuration = updateFormationDuration;

    function exportPDF() {
      const audit = calculateAudit();
      const formation = calculateFormation();
      const roi = calculateROI();
      const totalDevis = (state.includeAudit ? audit.total : 0) + (state.includeFormation ? formation.final : 0);
      const today = new Date().toLocaleDateString('fr-FR', { day: '2-digit', month: 'long', year: 'numeric' });
      
      let nextMeetingFormatted = '';
      if (state.nextMeetingDate) {
        const d = new Date(state.nextMeetingDate);
        nextMeetingFormatted = d.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
      }
      
      const printWindow = window.open('', '_blank');
      
      let html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>IAvenir - Devis</title>';
      html += '<style>';
      html += '* { margin: 0; padding: 0; box-sizing: border-box; }';
      html += 'body { font-family: Arial, sans-serif; padding: 25px 30px; color: #333; background: white; font-size: 11px; }';
      html += '.header { border-bottom: 3px solid #8B5CF6; padding-bottom: 12px; margin-bottom: 15px; overflow: hidden; }';
      html += '.logo { font-size: 26px; font-weight: bold; color: #8B5CF6; float: left; }';
      html += '.subtitle { font-size: 10px; color: #666; clear: left; }';
      html += '.date-box { float: right; text-align: right; }';
      html += '.date-label { font-size: 9px; color: #666; }';
      html += '.date { font-size: 11px; font-weight: 600; }';
      html += '.clear { clear: both; }';
      html += '.title { text-align: center; margin-bottom: 15px; }';
      html += '.title h1 { font-size: 18px; color: #333; margin-bottom: 3px; }';
      html += '.title p { color: #666; font-size: 11px; }';
      html += '.section-title { font-size: 12px; font-weight: bold; color: #8B5CF6; margin-bottom: 8px; padding-bottom: 5px; border-bottom: 1px solid #ddd; margin-top: 12px; }';
      html += '.service-box { background: #f9f9f9; border: 1px solid #ddd; padding: 12px; margin-bottom: 10px; overflow: hidden; }';
      html += '.service-left { float: left; width: 72%; }';
      html += '.service-right { float: right; width: 25%; text-align: right; }';
      html += '.service-name { font-size: 13px; font-weight: bold; color: #333; margin-bottom: 3px; }';
      html += '.service-desc { font-size: 10px; color: #666; margin-bottom: 6px; }';
      html += '.service-details { font-size: 10px; color: #555; line-height: 1.6; }';
      html += '.service-price { font-size: 18px; font-weight: bold; color: #8B5CF6; }';
      html += '.service-ht { font-size: 9px; color: #666; }';
      html += '.total-box { background: #8B5CF6; padding: 15px; margin-bottom: 12px; color: white; overflow: hidden; }';
      html += '.total-left { float: left; }';
      html += '.total-right { float: right; text-align: right; }';
      html += '.total-label { font-size: 12px; }';
      html += '.total-sub { font-size: 9px; opacity: 0.8; }';
      html += '.total-price { font-size: 24px; font-weight: bold; }';
      html += '.roi-container { margin-bottom: 12px; overflow: hidden; }';
      html += '.roi-box { float: left; width: 32%; background: #f9f9f9; border: 1px solid #ddd; padding: 8px; text-align: center; margin-right: 2%; }';
      html += '.roi-box-last { float: left; width: 32%; background: #f9f9f9; border: 1px solid #ddd; padding: 8px; text-align: center; margin-right: 0; }';
      html += '.roi-label { font-size: 8px; color: #666; margin-bottom: 2px; }';
      html += '.roi-value { font-size: 14px; font-weight: bold; color: #8B5CF6; }';
      html += '.two-cols { overflow: hidden; margin-bottom: 12px; }';
      html += '.col-left { float: left; width: 48%; }';
      html += '.col-right { float: right; width: 48%; }';
      html += '.next-steps { background: #f0f0ff; border: 1px solid #c7c7ff; padding: 12px; }';
      html += '.next-steps-title { font-size: 11px; font-weight: bold; color: #8B5CF6; margin-bottom: 8px; }';
      html += '.next-step-item { font-size: 10px; color: #555; margin-bottom: 4px; padding-left: 15px; position: relative; }';
      html += '.next-step-item:before { content: "‚Üí"; position: absolute; left: 0; color: #8B5CF6; }';
      html += '.next-step-date { font-size: 11px; font-weight: bold; color: #8B5CF6; margin-top: 6px; padding-top: 6px; border-top: 1px dashed #c7c7ff; }';
      html += '.contact-box { background: #f9f9f9; border: 1px solid #ddd; padding: 10px; overflow: hidden; }';
      html += '.contact-avatar { width: 35px; height: 35px; background: #8B5CF6; border-radius: 50%; color: white; font-weight: bold; font-size: 12px; text-align: center; line-height: 35px; float: left; margin-right: 10px; }';
      html += '.contact-info-box { overflow: hidden; }';
      html += '.contact-name { font-weight: bold; font-size: 12px; }';
      html += '.contact-role { font-size: 9px; color: #666; }';
      html += '.contact-info { font-size: 9px; color: #555; margin-top: 2px; }';
      html += '.footer { text-align: center; font-size: 9px; color: #999; padding-top: 10px; border-top: 1px solid #ddd; margin-top: 12px; }';
      html += '.green { color: #059669; }';
      html += '@media print { body { padding: 15px 20px; -webkit-print-color-adjust: exact; print-color-adjust: exact; } @page { margin: 10mm; size: A4; } }';
      html += '</style></head><body>';
      
      html += '<div class="header"><div class="date-box"><div class="date-label">Devis g√©n√©r√© le</div><div class="date">' + today + '</div></div>';
      html += '<div class="logo">IAvenir</div><div class="subtitle">Formation et conseil en Intelligence Artificielle</div><div class="clear"></div></div>';
      
      html += '<div class="title"><h1>Proposition Commerciale</h1><p>Accompagnement √† la transformation IA</p></div>';
      
      html += '<div class="section-title">Services inclus</div>';
      
      if (state.includeAudit) {
        html += '<div class="service-box"><div class="service-right"><div class="service-price">' + formatPrice(audit.total) + '</div><div class="service-ht">HT</div></div>';
        html += '<div class="service-left"><div class="service-name">Audit Strat√©gique IA</div>';
        html += '<div class="service-desc">Diagnostic complet et feuille de route personnalis√©e</div>';
        html += '<div class="service-details">';
        html += '‚Ä¢ <strong>' + audit.days + ' jours</strong> d\'immersion et d\'analyse<br>';
        html += '‚Ä¢ Cartographie des opportunit√©s IA par service<br>';
        html += '‚Ä¢ Priorisation des cas d\'usage √† fort ROI<br>';
        html += '‚Ä¢ Feuille de route d√©taill√©e + Quick Wins imm√©diats';
        html += '</div></div><div class="clear"></div></div>';
      }
      
      if (state.includeFormation) {
        html += '<div class="service-box"><div class="service-right"><div class="service-price">' + formatPrice(formation.final) + '</div><div class="service-ht">HT</div></div>';
        html += '<div class="service-left"><div class="service-name">Formation sur-mesure</div>';
        html += '<div class="service-desc">Mont√©e en comp√©tences de vos √©quipes</div>';
        html += '<div class="service-details">';
        html += '‚Ä¢ Format : <strong>' + (state.formationConfig.format === 'presentiel' ? 'Pr√©sentiel' : 'Distanciel') + '</strong> ¬∑ Dur√©e : <strong>' + state.formationConfig.duration + ' jour' + (state.formationConfig.duration > 1 ? 's' : '') + '</strong>/session<br>';
        html += '‚Ä¢ <strong>' + state.formationConfig.participants + '</strong> participants ¬∑ <strong>' + formation.sessions + '</strong> session' + (formation.sessions > 1 ? 's' : '') + ' (12 pers. max)';
        if (formation.discount > 0) {
          html += '<br><span class="green">‚Ä¢ Remise volume : -' + Math.round(formation.discount * 100) + '% (-' + formatPrice(formation.discountAmount) + ')</span>';
        }
        html += '</div></div><div class="clear"></div></div>';
      }
      
      html += '<div class="total-box"><div class="total-right"><div class="total-price">' + formatPrice(totalDevis) + '</div><div style="font-size: 10px;">HT</div></div>';
      html += '<div class="total-left"><div class="total-label">Investissement total</div><div class="total-sub">Hors frais de d√©placement √©ventuels</div></div><div class="clear"></div></div>';
      
      if (state.includeFormation) {
        html += '<div class="section-title">ROI Estim√©</div>';
        html += '<div class="roi-container">';
        html += '<div class="roi-box"><div class="roi-label">Temps gagn√© / pers. / sem.</div><div class="roi-value">' + roi.minTimeSaved + '-' + roi.maxTimeSaved + 'h</div></div>';
        html += '<div class="roi-box"><div class="roi-label">Gains nets estim√©s</div><div class="roi-value">' + formatPrice(roi.avgMonthlyGains) + '/mois</div></div>';
        html += '<div class="roi-box-last"><div class="roi-label">Retour sur invest.</div><div class="roi-value">' + roi.avgPayback.toFixed(1) + ' mois</div></div>';
        html += '<div class="clear"></div></div>';
      }
      
      html += '<div class="two-cols"><div class="col-left"><div class="next-steps">';
      html += '<div class="next-steps-title">üìã Prochaines √©tapes</div>';
      
      // Point de d√©part avec date
      html += '<div style="text-align:center; margin-bottom:8px;">';
      html += '<div style="display:inline-block; background:#8B5CF6; color:white; padding:6px 12px; border-radius:20px; font-size:10px; font-weight:bold;">';
      html += '‚ë† Point le : ' + (nextMeetingFormatted ? nextMeetingFormatted : '___________');
      html += '</div></div>';
      
      // Ligne verticale
      html += '<div style="text-align:center; margin-bottom:4px;"><div style="width:2px; height:10px; background:#ccc; margin:0 auto;"></div></div>';
      
      // Question
      html += '<div style="text-align:center; margin-bottom:8px;">';
      html += '<div style="display:inline-block; background:#e5e5e5; padding:4px 10px; border-radius:8px; font-size:9px; color:#555;">On avance ensemble ?</div>';
      html += '</div>';
      
      // Deux branches
      html += '<div style="overflow:hidden;">';
      // Branche Non
      html += '<div style="float:left; width:45%; text-align:center;">';
      html += '<div style="font-size:8px; color:#999; margin-bottom:4px;">‚Üª Pas maintenant</div>';
      html += '<div style="background:#f0f0f0; padding:6px; border-radius:6px; font-size:9px; color:#666;">On reste en contact</div>';
      html += '</div>';
      // Branche Oui
      html += '<div style="float:right; width:50%; text-align:center;">';
      html += '<div style="font-size:8px; color:#8B5CF6; margin-bottom:4px;">‚úì On avance</div>';
      html += '<div style="font-size:8px; color:#555; line-height:1.6;">';
      html += '<div style="background:#f5f5f5; padding:3px 6px; margin-bottom:2px; border-radius:4px;">Signature</div>';
      html += '<div style="background:#f5f5f5; padding:3px 6px; margin-bottom:2px; border-radius:4px;">Kick-off</div>';
      if (state.includeAudit) html += '<div style="background:#f5f5f5; padding:3px 6px; margin-bottom:2px; border-radius:4px;">Audit</div>';
      if (state.includeFormation) html += '<div style="background:#f5f5f5; padding:3px 6px; margin-bottom:2px; border-radius:4px;">Formation</div>';
      html += '<div style="background:#e8f5e9; padding:3px 6px; border-radius:4px; color:#2e7d32; font-weight:bold;">R√©sultats ‚úì</div>';
      html += '</div></div>';
      html += '<div class="clear"></div></div>';
      
      html += '</div></div>';
      
      html += '<div class="col-right"><div class="contact-box">';
      html += '<div class="contact-avatar">ML</div>';
      html += '<div class="contact-info-box"><div class="contact-name">Mathieu Legeas</div><div class="contact-role">Fondateur</div>';
      html += '<div class="contact-info">üìû 07 61 60 22 77</div>';
      html += '<div class="contact-info">‚úâÔ∏è mathieu.legeas@iavenir-formation.fr</div>';
      html += '</div><div class="clear"></div></div></div><div class="clear"></div></div>';
      
      html += '<div class="footer"><div><strong>IAvenir</strong> - Organisme certifi√© Qualiopi | www.iavenir-formation.fr</div></div>';
      
      html += '<script>window.onload = function() { setTimeout(function() { window.print(); }, 500); }<\/script>';
      html += '</body></html>';
      
      printWindow.document.write(html);
      printWindow.document.close();
    }
    
    window.exportPDF = exportPDF;
    
    // Fonction pour exporter toute la pr√©sentation
    function exportFullPresentation() {
      const audit = calculateAudit();
      const formation = calculateFormation();
      const roi = calculateROI();
      const totalDevis = (state.includeAudit ? audit.total : 0) + (state.includeFormation ? formation.final : 0);
      
      const printWindow = window.open('', '_blank');
      
      let html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>IAvenir - Pr√©sentation</title>';
      html += '<style>';
      html += '* { margin: 0; padding: 0; box-sizing: border-box; }';
      html += 'body { font-family: Arial, sans-serif; color: #333; background: white; }';
      html += '.page { page-break-after: always; padding: 40px; min-height: 100vh; }';
      html += '.page:last-child { page-break-after: avoid; }';
      html += '.header { text-align: center; margin-bottom: 30px; }';
      html += '.logo { font-size: 36px; font-weight: bold; color: #8B5CF6; }';
      html += '.subtitle { font-size: 14px; color: #666; }';
      html += 'h1 { font-size: 32px; text-align: center; margin-bottom: 10px; }';
      html += 'h2 { font-size: 24px; color: #8B5CF6; margin-bottom: 20px; text-align: center; }';
      html += 'h3 { font-size: 18px; margin-bottom: 15px; }';
      html += '.intro { text-align: center; font-size: 16px; color: #666; margin-bottom: 30px; }';
      html += '.two-cols { display: flex; gap: 30px; margin-bottom: 30px; }';
      html += '.col { flex: 1; }';
      html += '.box-gray { background: #f5f5f5; border: 1px solid #ddd; padding: 25px; border-radius: 12px; }';
      html += '.box-purple { background: #8B5CF6; color: white; padding: 25px; border-radius: 12px; }';
      html += '.badge { display: inline-block; padding: 6px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; margin-bottom: 15px; }';
      html += '.badge-gray { background: #e5e5e5; color: #666; }';
      html += '.badge-white { background: rgba(255,255,255,0.2); color: white; }';
      html += '.icon-circle { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 24px; }';
      html += '.icon-gray { background: #ddd; }';
      html += '.icon-white { background: rgba(255,255,255,0.2); }';
      html += '.box-title { font-size: 20px; font-weight: bold; margin-bottom: 15px; text-align: center; }';
      html += '.check-list { list-style: none; }';
      html += '.check-list li { padding: 8px 0; padding-left: 25px; position: relative; }';
      html += '.check-list li:before { content: "‚úì"; position: absolute; left: 0; color: white; }';
      html += '.timeline { display: flex; justify-content: space-between; margin-top: 30px; padding: 20px; background: linear-gradient(to right, #ddd, #8B5CF6); border-radius: 8px; }';
      html += '.timeline span { font-size: 12px; font-weight: bold; }';
      html += '.step-box { background: #f9f9f9; border: 1px solid #ddd; padding: 20px; border-radius: 12px; margin-bottom: 15px; }';
      html += '.step-number { width: 40px; height: 40px; background: #8B5CF6; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-bottom: 10px; }';
      html += '.step-title { font-size: 16px; font-weight: bold; color: #8B5CF6; margin-bottom: 5px; }';
      html += '.results-grid { display: flex; gap: 20px; margin-bottom: 20px; }';
      html += '.result-box { flex: 1; background: #f9f9f9; border: 1px solid #ddd; padding: 20px; border-radius: 12px; text-align: center; }';
      html += '.result-value { font-size: 28px; font-weight: bold; color: #8B5CF6; }';
      html += '.result-label { font-size: 14px; color: #333; margin-top: 5px; }';
      html += '.result-desc { font-size: 12px; color: #666; margin-top: 5px; }';
      html += '.config-box { background: white; border: 2px solid #8B5CF6; padding: 20px; border-radius: 12px; margin-bottom: 15px; }';
      html += '.config-title { font-size: 16px; font-weight: bold; margin-bottom: 10px; }';
      html += '.config-detail { font-size: 13px; color: #555; margin-bottom: 5px; }';
      html += '.config-price { font-size: 22px; font-weight: bold; color: #8B5CF6; text-align: right; }';
      html += '.total-box { background: #8B5CF6; color: white; padding: 20px; border-radius: 12px; text-align: center; }';
      html += '.total-label { font-size: 14px; }';
      html += '.total-price { font-size: 36px; font-weight: bold; }';
      html += '.cta-grid { display: flex; gap: 20px; }';
      html += '.cta-box { flex: 1; background: #f5f5f5; border: 1px solid #ddd; padding: 20px; border-radius: 12px; }';
      html += '.contact-avatar { width: 50px; height: 50px; background: #8B5CF6; border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-bottom: 10px; }';
      html += '.footer { text-align: center; padding: 20px; color: #999; font-size: 11px; border-top: 1px solid #ddd; margin-top: 30px; }';
      html += '@media print { .page { padding: 30px; } @page { margin: 10mm; } }';
      html += '</style></head><body>';
      
      // Page 1 - Hero
      html += '<div class="page">';
      html += '<div class="header"><div class="logo">IAvenir</div><div class="subtitle">Formation et conseil en Intelligence Artificielle</div></div>';
      html += '<h1>Transformez votre entreprise<br>gr√¢ce √† l\'IA</h1>';
      html += '<p class="intro">De l\'audit strat√©gique √† la mont√©e en comp√©tences de vos √©quipes,<br>nous vous accompagnons √† chaque √©tape.</p>';
      html += '<div class="two-cols">';
      html += '<div class="col"><div class="box-gray">';
      html += '<div class="badge badge-gray">POINT A ¬∑ AUJOURD\'HUI</div>';
      html += '<div class="icon-circle icon-gray">‚ùì</div>';
      html += '<div class="box-title">Votre Situation</div>';
      html += '<p style="text-align:center; color:#888; font-style:italic;">√Ä d√©finir ensemble lors de notre √©change...</p>';
      html += '</div></div>';
      html += '<div class="col"><div class="box-purple">';
      html += '<div class="badge badge-white">POINT B ¬∑ DANS 2-3 MOIS</div>';
      html += '<div class="icon-circle icon-white">üìà</div>';
      html += '<div class="box-title">Vos R√©sultats</div>';
      html += '<ul class="check-list">';
      html += '<li><strong>+15% √† +40% de productivit√©</strong><br><small style="opacity:0.8">Gains mesurables sur les t√¢ches quotidiennes</small></li>';
      html += '<li><strong>√âquipes autonomes et confiantes</strong><br><small style="opacity:0.8">Form√©es sur VOS cas d\'usage m√©tier</small></li>';
      html += '<li><strong>ROI mesurable et prouv√©</strong><br><small style="opacity:0.8">Retour sur investissement en quelques mois</small></li>';
      html += '<li><strong>Avantage comp√©titif durable</strong><br><small style="opacity:0.8">Une organisation qui ma√Ætrise l\'IA</small></li>';
      html += '</ul>';
      html += '</div></div>';
      html += '</div>';
      html += '<div class="timeline"><span style="color:#666">Aujourd\'hui</span><span style="color:#7c3aed">IA Performance</span><span style="color:white">IA Excellence</span></div>';
      html += '</div>';
      
      // Page 2 - M√©thodologie
      html += '<div class="page">';
      html += '<h2>Notre M√©thodologie</h2>';
      html += '<p class="intro">Un processus structur√© en 3 √©tapes pour une transformation IA r√©ussie</p>';
      html += '<div class="step-box"><div style="display:flex; gap:20px; align-items:flex-start;">';
      html += '<div class="step-number">1</div>';
      html += '<div><div class="step-title">Audit Strat√©gique</div>';
      html += '<p style="font-size:13px; color:#555;">Analyse approfondie de votre organisation pour identifier les opportunit√©s IA √† fort impact. Cartographie des processus, √©valuation de la maturit√©, priorisation des cas d\'usage.</p>';
      html += '</div></div></div>';
      html += '<div class="step-box"><div style="display:flex; gap:20px; align-items:flex-start;">';
      html += '<div class="step-number">2</div>';
      html += '<div><div class="step-title">Formation sur-mesure</div>';
      html += '<p style="font-size:13px; color:#555;">Programmes adapt√©s √† vos m√©tiers et cas d\'usage. Formations pratiques avec exercices concrets sur vos probl√©matiques r√©elles. Certification Qualiopi.</p>';
      html += '</div></div></div>';
      html += '<div class="step-box"><div style="display:flex; gap:20px; align-items:flex-start;">';
      html += '<div class="step-number">3</div>';
      html += '<div><div class="step-title">Accompagnement continu</div>';
      html += '<p style="font-size:13px; color:#555;">Suivi post-formation, mesure des r√©sultats, ajustements. Nous vous accompagnons jusqu\'√† l\'autonomie compl√®te de vos √©quipes.</p>';
      html += '</div></div></div>';
      html += '</div>';
      
      // Page 3 - R√©sultats
      html += '<div class="page">';
      html += '<h2>R√©sultats pour l\'entreprise</h2>';
      html += '<p class="intro">Ce que vous pouvez attendre de notre accompagnement</p>';
      html += '<div class="results-grid">';
      html += '<div class="result-box"><div class="result-value">2-5h</div><div class="result-label">gagn√©es / personne / semaine</div><div class="result-desc">Temps lib√©r√© pour les t√¢ches strat√©giques</div></div>';
      html += '<div class="result-box"><div class="result-value">Humain</div><div class="result-label">Engagement & bien-√™tre</div><div class="result-desc">√âquipes valoris√©es sur des t√¢ches √† forte valeur</div></div>';
      html += '<div class="result-box"><div class="result-value">98%</div><div class="result-label">Taux de satisfaction</div><div class="result-desc">Nos clients recommandent IAvenir</div></div>';
      html += '</div>';
      html += '<div style="text-align:center; margin-top:30px; padding:15px; background:#f5f5f5; border-radius:8px;">';
      html += '<strong>üèÜ +50 entreprises nous font d√©j√† confiance</strong>';
      html += '</div>';
      html += '</div>';
      
      // Page 4 - Configuration
      html += '<div class="page">';
      html += '<h2>Votre Configuration</h2>';
      if (state.includeAudit) {
        html += '<div class="config-box"><div style="display:flex; justify-content:space-between; align-items:flex-start;">';
        html += '<div><div class="config-title">üîç Audit Strat√©gique</div>';
        html += '<div class="config-detail">‚Ä¢ Dur√©e : <strong>' + audit.days + ' jours</strong></div>';
        html += '<div class="config-detail">‚Ä¢ Collaborateurs : <strong>' + state.auditConfig.collaborateurs + '</strong></div>';
        html += '<div class="config-detail">‚Ä¢ Livrables : Plan d\'action, roadmap, quick wins</div>';
        html += '</div>';
        html += '<div class="config-price">' + formatPrice(audit.total) + ' HT</div>';
        html += '</div></div>';
      }
      if (state.includeFormation) {
        html += '<div class="config-box"><div style="display:flex; justify-content:space-between; align-items:flex-start;">';
        html += '<div><div class="config-title">üéì Formation sur-mesure</div>';
        html += '<div class="config-detail">‚Ä¢ Format : <strong>' + (state.formationConfig.format === 'presentiel' ? 'Pr√©sentiel' : 'Distanciel') + '</strong></div>';
        html += '<div class="config-detail">‚Ä¢ Dur√©e : <strong>' + state.formationConfig.duration + ' jour' + (state.formationConfig.duration > 1 ? 's' : '') + '</strong> par session</div>';
        html += '<div class="config-detail">‚Ä¢ Participants : <strong>' + state.formationConfig.participants + '</strong> personnes</div>';
        html += '<div class="config-detail">‚Ä¢ Sessions : <strong>' + formation.sessions + '</strong> session' + (formation.sessions > 1 ? 's' : '') + '</div>';
        if (formation.discount > 0) {
          html += '<div class="config-detail" style="color:#059669;">‚Ä¢ Remise volume : -' + Math.round(formation.discount * 100) + '%</div>';
        }
        html += '</div>';
        html += '<div class="config-price">' + formatPrice(formation.final) + ' HT</div>';
        html += '</div></div>';
      }
      html += '<div class="total-box"><div class="total-label">Investissement total</div><div class="total-price">' + formatPrice(totalDevis) + ' HT</div></div>';
      if (state.includeFormation) {
        html += '<div style="margin-top:20px;"><h3 style="color:#8B5CF6; margin-bottom:15px;">ROI Estim√©</h3>';
        html += '<div class="results-grid">';
        html += '<div class="result-box"><div class="result-value">' + roi.minTimeSaved + '-' + roi.maxTimeSaved + 'h</div><div class="result-label">Temps gagn√© / pers. / sem.</div></div>';
        html += '<div class="result-box"><div class="result-value">' + formatPrice(roi.avgMonthlyGains) + '</div><div class="result-label">Gains nets / mois</div></div>';
        html += '<div class="result-box"><div class="result-value">' + roi.avgPayback.toFixed(1) + ' mois</div><div class="result-label">Retour sur invest.</div></div>';
        html += '</div></div>';
      }
      html += '</div>';
      
      // Page 5 - Contact
      html += '<div class="page">';
      html += '<h2>Passons √† l\'action</h2>';
      html += '<div class="cta-grid">';
      html += '<div class="cta-box"><h3>üìã Prochaines √©tapes</h3>';
      html += '<div style="margin:15px 0;"><div style="display:inline-block; background:#8B5CF6; color:white; padding:8px 15px; border-radius:20px; font-size:12px;">‚ë† Point de validation</div></div>';
      html += '<p style="font-size:13px; color:#555; margin-bottom:10px;">On avance ensemble ?</p>';
      html += '<div style="display:flex; gap:15px;">';
      html += '<div style="flex:1; text-align:center;"><div style="font-size:11px; color:#999; margin-bottom:5px;">‚Üª Pas maintenant</div><div style="background:#eee; padding:10px; border-radius:8px; font-size:12px; color:#666;">On reste en contact</div></div>';
      html += '<div style="flex:1; text-align:center;"><div style="font-size:11px; color:#8B5CF6; margin-bottom:5px;">‚úì On avance</div>';
      html += '<div style="font-size:11px; color:#555;">';
      html += '<div style="background:#f5f5f5; padding:5px; margin-bottom:3px; border-radius:4px;">Signature</div>';
      html += '<div style="background:#f5f5f5; padding:5px; margin-bottom:3px; border-radius:4px;">Kick-off</div>';
      if (state.includeAudit) html += '<div style="background:#f5f5f5; padding:5px; margin-bottom:3px; border-radius:4px;">Audit</div>';
      if (state.includeFormation) html += '<div style="background:#f5f5f5; padding:5px; margin-bottom:3px; border-radius:4px;">Formation</div>';
      html += '<div style="background:#e8f5e9; padding:5px; border-radius:4px; color:#2e7d32; font-weight:bold;">R√©sultats ‚úì</div>';
      html += '</div></div>';
      html += '</div></div>';
      html += '<div class="cta-box"><h3>üë§ Votre contact</h3>';
      html += '<div style="display:flex; align-items:center; gap:15px; margin-top:15px;">';
      html += '<div class="contact-avatar">ML</div>';
      html += '<div><div style="font-weight:bold; font-size:16px;">Mathieu Legeas</div><div style="font-size:12px; color:#666;">Fondateur</div>';
      html += '<div style="font-size:13px; color:#555; margin-top:8px;">üìû 07 61 60 22 77</div>';
      html += '<div style="font-size:13px; color:#555;">‚úâÔ∏è mathieu.legeas@iavenir-formation.fr</div>';
      html += '</div></div>';
      html += '<div style="margin-top:15px; padding-top:15px; border-top:1px solid #ddd; font-size:12px; color:#666;">üèÜ Organisme certifi√© Qualiopi</div>';
      html += '</div>';
      html += '</div>';
      html += '<div class="footer"><strong>IAvenir</strong> - Formation et conseil en Intelligence Artificielle<br>www.iavenir-formation.fr</div>';
      html += '</div>';
      
      html += '<script>window.onload = function() { setTimeout(function() { window.print(); }, 500); }<\/script>';
      html += '</body></html>';
      
      printWindow.document.write(html);
      printWindow.document.close();
    }
    window.exportPresentation = exportFullPresentation;
    
    render();
  </script>
</body>
</html>
